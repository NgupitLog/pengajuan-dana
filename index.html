<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Form Pengajuan Estimasi Dana</title>

<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  padding:20px;
}
h2 { color:#0b4ea2; }

.header, .so-block {
  background:#fff;
  padding:15px;
  border-radius:6px;
  margin-bottom:20px;
  border-left:5px solid #ff8c00;
}

label { font-size:13px; font-weight:bold; }
input, select {
  width:100%;
  padding:6px;
  margin-bottom:10px;
  font-size:13px;
}

.row { display:flex; gap:10px; }
.col { flex:1; }

table { width:100%; border-collapse:collapse; margin-top:10px; }
th {
  background:#0b4ea2;
  color:#fff;
  padding:6px;
}
td { padding:6px; }

.btn {
  background:#ff8c00;
  color:#fff;
  border:none;
  padding:6px 12px;
  border-radius:4px;
  cursor:pointer;
}
.btn-blue { background:#0b4ea2; }
.btn-danger { background:#e74c3c; }

.total {
  margin-top:10px;
  font-weight:bold;
}
</style>
</head>

<body>

<h2>Form Pengajuan Estimasi Dana</h2>

<div class="header">
  <div class="row">
    <div class="col">
      <label>PIC</label>
      <select id="pic">
        <option value="">-- pilih --</option>
      </select>
    </div>

    <div class="col">
      <label>Belongs To</label>
      <select id="belongsTo">
        <option value="">-- pilih --</option>
        <option>Ngupit</option>
        <option>Paksi</option>
      </select>
    </div>

    <div class="col">
      <label>Company Name</label>
      <select id="companyName">
        <option value="">-- pilih company --</option>
      </select>
    </div>
  </div>
</div>

<div id="soContainer"></div>

<button class="btn btn-blue" id="btnAddSO">+ Tambah SO</button>
<br><br>
<button class="btn" id="btnSubmit">SUBMIT</button>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwLS1VOGQkYqBTkyJTtwA22yldbHC1SCmyvmXPKsa1Yl8IOFUVfIoL6XQcOi9jFVRqNVQ/exec";

  const picSelect = document.getElementById("pic");
  const belongsToSelect = document.getElementById("belongsTo");
  const companySelect = document.getElementById("companyName");
  const soContainer = document.getElementById("soContainer");
  const btnSubmit = document.getElementById("btnSubmit");
  const btnAddSO = document.getElementById("btnAddSO");

  /* LOAD PIC */
  fetch(SCRIPT_URL + "?type=pic")
    .then(r => r.json())
    .then(list => list.forEach(v =>
      picSelect.insertAdjacentHTML("beforeend", `<option>${v}</option>`)
    ));

  /* LOAD COMPANY */
  fetch(SCRIPT_URL + "?type=company")
    .then(r => r.json())
    .then(list => list.forEach(v =>
      companySelect.insertAdjacentHTML("beforeend", `<option>${v}</option>`)
    ));

  function addSO() {
    const so = document.createElement("div");
    so.className = "so-block";
    so.innerHTML = `
      <h3>Detail SO</h3>
      <input class="soNumber" placeholder="SO Number">
      <input class="blAju" placeholder="BL / AJU">
      <select class="shipmentType"><option>FCL</option><option>LCL</option></select>
      <input class="qty" placeholder="QTY">
    `;
    soContainer.appendChild(so);
  }

  btnAddSO.addEventListener("click", addSO);

  btnSubmit.addEventListener("click", () => {
    alert("SUBMIT OK (logic backend sudah ada)");
  });

  addSO(); // default 1
});
</script>

</body>
</html>
